// Variables (module) - must come before any CSS rules or @import statements
@use 'variables' as *;

// Bootstrap wrapper (legacy @import shim)
@import 'bootstrap-wrapper';

// Fonts (keep as a plain CSS import)
@import url('https://fonts.bunny.net/css?family=Poppins:400,500,600|Inter:400,500');

/*
MYDS CSS custom properties (tokens).
Defined here so runtime theme switching via [data-theme] can swap values.
Fallbacks use SASS variables where available to remain compatible with the existing
SASS architecture.
*/
:root {
	/* Font tokens (MYDS) */
	--font-body: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
	--font-heading: 'Poppins', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
	/* Primitive / brand */
	--primary: #3A75F6; /* MYDS primary (primary-500) */
	--danger: #EF4444; /* danger-500 */
	--success: #22C55E; /* success-500 */
	--warning: #EAB308; /* warning-500 */

	/* Background / surfaces */
	--bg-page: #FAFAFA; /* gray-50 */
	--bg-surface: #FFFFFF; /* white */
	--bg-muted: #F4F4F5; /* gray-100 / washed */

	/* Text */
	--txt-primary: #18181B; /* gray-900 */
	--txt-muted: #71717A; /* gray-500 */
	--txt-disabled: #52525B; /* gray-600 per MYDS text disabled (light) */

	/* Outlines / focus */
	--otl-default: rgba(15,23,42,0.06);
	/* focus ring uses primary-300 (#96B7FF) at reduced opacity */
	--fr: rgba(150,183,255,0.4);
	--fr-shadow: rgba(150,183,255,0.12);

	/* Motion */
	--motion-short: 200ms;
	--motion-medium: 400ms;
	--motion-long: 600ms;

	/* Radius */
	--radius-xs: 4px;
	--radius-s: 6px;
	--radius-m: 8px;
	--radius-l: 12px;
	--radius-xl: 14px;

	/* MYDS token aliases for text/background/outlines */
	--txt-on-primary: #ffffff;
	--otl-primary: rgba(58,117,246,0.12);
	--bg-primary-surface: var(--primary);
}

/* Dark theme token overrides */
[data-theme="dark"] {
	/* In dark mode we prefer lighter accents mapped to the MYDS dark palette */
	--primary: #6394FF; /* primary-400 mapped for dark surfaces */
	--danger: #FF6B6B; /* danger-400/darker accent */
	--success: #2DD4BF; /* success-400 */
	--warning: #F59E0B; /* warning-400 */

	--bg-page: #161619; /* gray-930 */
	--bg-surface: #1D1D21; /* gray-850 */
	--bg-muted: #27272A; /* gray-800 */

	--txt-primary: #FFFFFF; /* text on dark */
	--txt-muted: #D4D4D8; /* gray-300 */
	--txt-disabled: #A1A1AA; /* gray-400 per MYDS text disabled (dark) */

	--otl-default: rgba(255,255,255,0.04);
	/* Focus ring per MYDS: primary-700 at 40% */
	--fr: rgba(29,78,216,0.4);
	--fr-shadow: rgba(29,78,216,0.12);
}

// MYDS-style focus ring utility using tokens
.focus-ring {
	outline: 2px solid var(--fr) !important;
	outline-offset: 2px !important;
	box-shadow: 0 0 0 4px var(--fr-shadow) !important;
}

// Global focus style for interactive elements (use :focus-visible)
// Apply to most interactive and tabbable controls, including ARIA roles.
:is(
	a[href],
	button,
	[role="button"],
	input,
	select,
	textarea,
	.btn,
	.myds-btn,
	.nav-link,
	.dropdown-item,
	.list-group-item-action,
	.page-link,
	[role="menuitem"],
	[role="radio"],
	[role="checkbox"],
	[tabindex]:not([tabindex="-1"])
):focus-visible {
	outline: 2px solid var(--fr) !important;
	outline-offset: 2px !important;
	box-shadow: 0 0 0 4px var(--fr-shadow) !important;
	transition: outline-color var(--motion-short);
}

// Hover affordance: show a subtle ring on hover for most interactive elements
:is(
	a[href],
	button,
	[role="button"],
	[role="link"],
	.btn,
	.myds-btn,
	.nav-link,
	.dropdown-item,
	.list-group-item-action,
	.page-link,
	input,
	select,
	textarea
):not(:disabled):not([aria-disabled="true"]):not([readonly]):hover {
	box-shadow: 0 0 0 2px var(--fr-shadow);
}

// MYDS button utilities
.myds-btn{
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding: .375rem .75rem;
	border-radius: .25rem;
	font-size: .875rem;
	line-height: 1;
	cursor: pointer;
	text-decoration: none;
	transition: background-color var(--motion-short) ease, color var(--motion-short) ease, box-shadow var(--motion-short) ease, border-color var(--motion-short) ease;
}
.myds-btn--primary{
	background-color: var(--primary);
	color: var(--txt-on-primary);
	border: 1px solid var(--otl-default);
}
.myds-btn--secondary{
	background-color: transparent;
	color: var(--txt-primary);
	border: 1px solid var(--otl-primary);
}
.myds-btn--danger{
	background-color: var(--danger);
	color: #ffffff;
	border: 1px solid var(--otl-default);
}
.myds-btn--success{
	background-color: var(--success);
	color: #ffffff;
	border: 1px solid var(--otl-default);
}
.myds-action--danger{ color: var(--danger) !important; }

/* Tertiary button (link-styled button) */
.myds-btn--tertiary{
	background-color: transparent;
	color: var(--primary);
	border: 1px solid transparent;
	padding: 0.25rem 0.25rem; /* tighter like a link */
}
.myds-btn--tertiary:hover{ text-decoration: underline; }

/* View button consistency tweaks used in index tables */
.btn-outline-secondary.myds-btn--secondary {
	padding: .35rem .6rem;
	min-height: 38px;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	gap: .5rem;
}

/* Mobile stacked buttons should expand full width and maintain readable tap targets */
@media (max-width: 576px) {
	.btn-block.myds-btn--secondary {
		display: block !important;
		width: 100% !important;
		min-height: 44px !important;
		padding: .5rem .75rem !important;
	}
}

/* Nav / Brand helpers */
.myds-nav{ background-color: var(--bg-surface); border-bottom: 1px solid var(--otl-default); }
.myds-brand{ color: var(--txt-primary); font-weight: 600; }
.myds-brand:hover{ color: var(--primary); text-decoration: none; }

/* Header search alignment */
.navbar form[role="search"] input[type="search"]{
	min-width: 200px;
}
.navbar .nav-link { color: var(--txt-primary); }
.navbar .nav-link:hover { color: var(--primary); }

/* Dropdown toggle caret/icon visibility tuned for dark and light modes */
.nav-link.dropdown-toggle::after {
	color: var(--txt-primary);
	margin-left: .25rem;
}

/* Active nav item uses primary and a subtle underline per MYDS */
.navbar .nav-link.active, .navbar .nav-link[aria-current="page"] {
	color: var(--primary);
	text-decoration: underline;
}

/* Article container per MYDS (max 640px) */
.myds-article{ max-width: 640px; margin-left: auto; margin-right: auto; }
.myds-media-wide{ max-width: 740px; margin-left: auto; margin-right: auto; }

// Typography defaults
body {
		font-family: var(--font-body);
		background-color: var(--bg-page);
		color: var(--txt-primary);
}

/* Surface tokens */
.card, .card-body, .bg-surface {
	background-color: var(--bg-surface) !important;
	color: var(--txt-primary) !important;
}

/* Muted text */
.text-muted {
	color: var(--txt-muted) !important;
}

/* Navbar mapping */
.navbar, .navbar-light, .navbar-dark {
	background-color: var(--bg-surface) !important;
	border-bottom: 1px solid var(--otl-default);
}

/* Forms */
input, textarea, select {
	background-color: var(--bg-surface);
	color: var(--txt-primary);
	border: 1px solid var(--otl-default);
}

input::placeholder, textarea::placeholder {
	color: var(--txt-muted);
}

/* Buttons */
.btn {
	transition: background-color 180ms ease, color 180ms ease, box-shadow 180ms ease;
	/* Ensure default bootstrap buttons respect MYDS tokens */
	background-color: transparent;
	color: var(--txt-primary);
	border-radius: var(--radius-s);
	border: 1px solid var(--otl-default);
}

/* Primary / secondary / danger / success mapping for Bootstrap classes */
.btn-primary, .btn.btn-primary {
	background-color: var(--primary) !important;
	color: var(--txt-on-primary) !important;
	border-color: var(--otl-primary);
	box-shadow: none;
}
.btn-outline-primary {
	background-color: transparent !important;
	color: var(--primary) !important;
	border: 1px solid var(--otl-primary) !important;
}
.btn-secondary, .btn.btn-secondary {
	background-color: transparent !important;
	color: var(--txt-primary) !important;
	border: 1px solid var(--otl-primary) !important;
}
.btn-outline-secondary {
	background-color: transparent !important;
	color: var(--txt-primary) !important;
	border: 1px solid var(--otl-primary) !important;
}
.btn-danger, .btn.btn-danger, .btn-outline-danger {
	background-color: var(--danger) !important;
	color: #fff !important;
	border: 1px solid rgba(0,0,0,0.08) !important;
}
.btn-success {
	background-color: var(--success) !important;
	color: #fff !important;
	border: 1px solid rgba(0,0,0,0.04) !important;
}

/* Small / block sizing consistent with MYDS tap targets */
.btn-sm {
	padding: .35rem .6rem;
	font-size: .8125rem;
}
.btn-block, .btn.w-100 {
	display: block !important;
	width: 100% !important;
}

/* Link styled buttons map to MYDS tertiary */
.btn-link, .btn.btn-link, .myds-btn--tertiary {
	background: transparent !important;
	border: none !important;
	color: var(--primary) !important;
	padding: 0 !important;
}

/* Ensure outline styles still show focus ring using MYDS tokens */
.btn:focus-visible, .btn:focus {
	outline: 2px solid var(--fr) !important;
	outline-offset: 2px !important;
	box-shadow: 0 0 0 4px var(--fr-shadow) !important;
}

/* MYDS utility variants so views can use myds-* classes exclusively */
.myds-btn--sm {
	padding: .35rem .6rem;
	font-size: .8125rem;
}
.myds-btn--block {
	display: block !important;
	width: 100% !important;
}
.myds-btn--outline {
	background-color: transparent !important;
	color: var(--primary) !important;
	border: 1px solid var(--otl-primary) !important;
}

/* Links */
a {
	color: var(--primary);
}

/* Tables */
table {
	color: var(--txt-primary);
}

table thead th {
	background-color: var(--bg-muted);
	color: var(--txt-primary);
}

/* Badges / alerts */
.badge, .alert {
	background-color: var(--bg-surface);
	color: var(--txt-primary);
	border: 1px solid var(--otl-default);
}

/* Modals */
.modal-content {
	background-color: var(--bg-surface);
	color: var(--txt-primary);
}

/* Dropdown menus */
.dropdown-menu {
	background-color: var(--bg-surface);
	color: var(--txt-primary);
	border: 1px solid var(--otl-default);
}

/* Dropdown item text colour per MYDS (use txt-primary; disabled uses txt-disabled).
   Do not override items that are styled as myds-btn (e.g., destructive actions). */
.dropdown-menu .dropdown-item:not(.myds-btn) {
	color: var(--txt-primary) !important;
}
.dropdown-menu .dropdown-item:not(.myds-btn):hover,
.dropdown-menu .dropdown-item:not(.myds-btn):focus {
	color: var(--txt-primary) !important;
	background-color: var(--bg-muted) !important; /* washed */
}
.dropdown-menu .dropdown-item:not(.myds-btn).active,
.dropdown-menu .dropdown-item:not(.myds-btn):active {
	color: var(--txt-primary) !important;
	background-color: var(--bg-muted) !important;
}
.dropdown-menu .dropdown-item.disabled,
.dropdown-menu .dropdown-item:disabled {
	color: var(--txt-disabled) !important;
	pointer-events: none;
	opacity: 0.8;
}

/* Focus utilities */
.focus-ring {
	outline: 2px solid var(--fr) !important;
	outline-offset: 2px !important;
	box-shadow: 0 0 0 4px var(--fr-shadow) !important;
}

/* Small transition for theme swap */
:root, [data-theme="dark"] {
	transition: background-color 200ms ease, color 200ms ease;
}

h1,h2,h3,h4,h5,h6 {
	font-family: var(--font-heading);
	font-weight: 600;
}

/* Slightly larger tap targets for MYDS buttons */
.myds-btn { border-radius: var(--radius-s); padding: .5rem .875rem; }

/* Ensure dropdown items receive focus-visible styles in all browsers */
.dropdown-menu .dropdown-item:focus-visible {
	outline: 2px solid var(--fr) !important;
	outline-offset: 2px !important;
	box-shadow: 0 0 0 4px var(--fr-shadow) !important;
}
